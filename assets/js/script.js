---
---

function clearFields() {
    document.getElementById('semester').value = '';
    document.getElementById('subject').value = '';
    document.getElementById('year').value = '';
    document.getElementById('lecturer').value = '';
}

var noteElement;
function addFilteredNotes() {
    var url = new URL(window.location.href);
    var semester = url.searchParams.get("semester");
    var subject = url.searchParams.get("subject");
    var year = url.searchParams.get("year");
    var lecturer = url.searchParams.get("lecturer");

    document.getElementById('semester').value = semester;
    document.getElementById('subject').value = subject;
    document.getElementById('year').value = year;
    document.getElementById('lecturer').value = lecturer;

    {% for note in site.data.autoGenerated.notesList %}
        if ((semester == null || semester == "" || '{{ note.semester }}' == semester) &&
            (year == null || year == "" || {{ note.year }} == year) &&
            (lecturer == null || '{{ note.lecturer }}'.includes(lecturer))) {
            noteElement = document.getElementById('{{ note.id }}');
            noteElement.innerHTML = '{{note.semester}},<br> {{ note.subject }},<br> {{ note.year }},<br> {{ note.lecturer }} <hr>';
            let aliases = '{{ note.subject }}'.slice(1, -1).split('|');
            aliases.forEach(function(item, index, array) {
                noteElement.innerHTML += item + ' ' + index + '; ';
            })
            noteElement.innerHTML += '<hr>';

        }
            noteElement = document.getElementById('{{ note.id }}');
    {% endfor %}
    const mystuff = [{file:'Monitor.cpp'}, {file:'MeshRenderer.cpp'}]
    results = fuzzysort.go('mr', mystuff, {key:'file'})
    
    document.getElementById('ttest').innerHTML = results 
}
function capitalizeFirstLetter(string) {
  return string.charAt(0).toUpperCase() + string.slice(1);
}
function search() {
    var semester = document.getElementById('semester').value;
    var subject = document.getElementById('subject').value;
    var year = document.getElementById('year').value;
    var lecturer = document.getElementById('lecturer').value;
    
    var notesList = [];
    {% for note in site.data.autoGenerated.notesList %}
        if ((semester == null || semester == "" || '{{ note.semester }}' == semester) &&
            (year == null || year == "" || {{ note.year }} == year) &&
            (lecturer == null || '{{ note.lecturer }}'.includes(lecturer))) {
            let aliases = {'subjects': '{{ note.subject }}'.slice(1, -1).split('|'),
                'lecturers': '{{ note.lecturer }}'.slice(1, -1).split('|')};
            results = fuzzysort.go(subject, aliases['subjects'])
            maxScore = Number.NEGATIVE_INFINITY
            results.forEach(function(item, index, array) {
                maxScore < item['score'] ? maxScore = item['score'] : 0;
            })
            var noteHTML = '<div><a href="/tree?year=2020" class="note-btn">' +
                'Sem: {{ note.semester }}' + 
                '<hr style="width:100px;color:lightgray">Subj: ' + capitalizeFirstLetter(aliases['subjects'][0]) + 
                '<hr style="width:100px;color:lightgray">Year: {{ note.year}}' +
                '<hr style="width:100px;color:lightgray">Lec: ' + aliases['lecturers'][0] + '</a></div>';
            notesList.push([maxScore, noteHTML]);
        } else {
        }
    {% endfor %}
    notesList.sort(function(first, second) {
        return second[0] - first[0];
    });
    var notesListSection = document.getElementById('notes-list');
    notesListSection.innerHTML = '';
    notesList.forEach(function(item, index, array) {
        notesListSection.innerHTML += item[1];
    })
}

